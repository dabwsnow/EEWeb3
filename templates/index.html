<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Baza pytaÅ„</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body class="light">
    <button id="theme-toggle">ðŸŒ™ ZmieÅ„ motyw</button>
    <button id="scroll-top" style="display: none;">â†‘</button>
    <main>
        <div class="search-container">
            <input type="text" id="search-input" placeholder="Szukaj pytaÅ„...">
        </div>
        {% for q in questions %}
        <div class="question-box">
            <div class="question">{{ q[0]|e }} <button class="copy-btn" title="Skopiuj pytanie">ðŸ“‹</button></div>
            <ul class="answers">
                <li {% if q[5]==0 %}class="correct"{% endif %}>{{ q[1]|e }}</li>
                <li {% if q[5]==1 %}class="correct"{% endif %}>{{ q[2]|e }}</li>
                <li {% if q[5]==2 %}class="correct"{% endif %}>{{ q[3]|e }}</li>
                <li {% if q[5]==3 %}class="correct"{% endif %}>{{ q[4]|e }}</li>
            </ul>
            {% if q[6] %}
            <img src="/{{ q[6].split('/')[-1] }}" alt="Obrazek pytania" loading="lazy">
            {% endif %}
        </div>
        {% endfor %}
    </main>
    <script>
        // Theme toggle with animation and localStorage
        const btn = document.getElementById('theme-toggle');
        const body = document.body;
        const savedTheme = localStorage.getItem('theme') || 'light';
        body.classList.add(savedTheme);
        btn.addEventListener('click', () => {
            body.style.opacity = '0';
            setTimeout(() => {
                body.classList.toggle('dark');
                body.classList.toggle('light');
                const newTheme = body.classList.contains('dark') ? 'dark' : 'light';
                localStorage.setItem('theme', newTheme);
                body.style.opacity = '1';
            }, 300);
        });

        // Animate question boxes on load
        const questionBoxes = document.querySelectorAll('.question-box');
        questionBoxes.forEach((box, index) => {
            setTimeout(() => {
                box.classList.add('visible');
            }, index * 150);
        });

        // Search functionality with slide animation
        const searchInput = document.getElementById('search-input');
        searchInput.addEventListener('input', () => {
            const filter = searchInput.value.toLowerCase();
            questionBoxes.forEach(box => {
                const questionText = box.querySelector('.question').textContent.toLowerCase();
                box.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                box.style.transform = questionText.includes(filter) ? 'translateX(0)' : 'translateX(-20px)';
                box.style.opacity = questionText.includes(filter) ? '1' : '0';
                box.style.display = questionText.includes(filter) ? 'block' : 'none';
            });
        });

        // Highlight question on click
        questionBoxes.forEach(box => {
            box.addEventListener('click', () => {
                questionBoxes.forEach(b => b.classList.remove('highlighted'));
                box.classList.add('highlighted');
            });
        });

        // Scroll to top button
        const scrollTopBtn = document.getElementById('scroll-top');
        window.addEventListener('scroll', () => {
            scrollTopBtn.style.display = window.scrollY > 200 ? 'block' : 'none';
        });
        scrollTopBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Copy question text
        document.querySelectorAll('.copy-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation(); // Prevent triggering highlight
                const questionText = btn.parentElement.textContent.replace('ðŸ“‹', '').trim();
                navigator.clipboard.writeText(questionText).then(() => {
                    btn.textContent = 'âœ“';
                    setTimeout(() => btn.textContent = 'ðŸ“‹', 1000);
                });
            });
        });
    </script>
</body>
</html>